# Light/Dark Mode Setup Guide

Panduan lengkap untuk mengimplementasikan fitur Light/Dark Mode di Next.js dengan Tailwind CSS dan next-themes.

## Overview

Setup ini menggunakan:
- **next-themes**: Library untuk mengelola tema (light/dark) dengan persistent storage
- **Tailwind CSS**: Untuk styling dark mode
- **CSS Variables**: Untuk mengontrol background dan text color

---

## ğŸ“‹ Step-by-Step Setup

### Step 1: Install Dependencies

Pastikan `next-themes` sudah terinstall:

```bash
npm install next-themes
```

Verifikasi di `package.json` bahwa dependencies sudah ada:
```json
{
  "dependencies": {
    "next-themes": "^0.4.6",
    "react": "19.2.3",
    "react-dom": "19.2.3"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "tailwindcss": "^4"
  }
}
```

---

### Step 2: Update `tailwind.config.js`

Pastikan konfigurasi Tailwind menggunakan `darkMode: 'class'`:

```javascript
module.exports = {
  darkMode: 'class',  // â† PENTING: gunakan 'class' bukan 'media'
  content: [
    "./app/**/*.{js,ts,jsx,tsx}",
    "./pages/**/*.{js,ts,jsx,tsx}",
    "./components/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

**Penjelasan:**
- `darkMode: 'class'` â†’ Tema diatur berdasarkan class `dark` di element `<html>`
- next-themes akan otomatis menambah/menghapus class `dark` saat user toggle

---

### Step 3: Update `app/globals.css`

Ini adalah CSS global yang mengatur warna background dan text untuk seluruh halaman:

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --bg: #ffffff;    /* Background color light mode */
  --fg: #000000;    /* Text color light mode */
}

html.dark {
  --bg: #0a0a0a;    /* Background color dark mode */
  --fg: #ffffff;    /* Text color dark mode */
}

html {
  background-color: var(--bg);
  color: var(--fg);
  transition: background-color 150ms linear, color 150ms linear;
}

body {
  background-color: var(--bg);
  color: var(--fg);
  min-height: 100vh;
}
```

**Penjelasan:**
- `:root` â†’ CSS variables untuk light mode (default)
- `html.dark` â†’ CSS variables untuk dark mode (saat class `dark` ada)
- `transition` â†’ Animasi smooth saat berganti tema
- `min-height: 100vh` â†’ Background cover seluruh viewport

---

### Step 4: Update `app/layout.tsx`

Ini adalah root layout. Tambahkan `ThemeProvider` dan `ThemeToggle`:

```tsx
import type { Metadata } from "next"
import { Geist, Geist_Mono } from "next/font/google"
import "./globals.css"
import { ThemeProvider } from "next-themes"
import ThemeToggle from "../components/ThemeToggle"

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
})

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
})

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en" suppressHydrationWarning>
      <body
        className={`${geistSans.variable} ${geistMono.variable}`}
      >
        <ThemeProvider
          attribute="class"
          defaultTheme="system"
          enableSystem
        >
          <header className="p-4 flex justify-end">
            <ThemeToggle />
          </header>
          {children}
        </ThemeProvider>
      </body>
    </html>
  )
}
```

**Penjelasan:**
- `suppressHydrationWarning` â†’ Mencegah warning saat next-themes inject script
- `<ThemeProvider>` â†’ Wrapper yang enable theme functionality
  - `attribute="class"` â†’ Ubah class di element `<html>`
  - `defaultTheme="system"` â†’ Gunakan system preference sebagai default
  - `enableSystem` â†’ Respect system dark mode preference
- `<ThemeToggle />` â†’ Tombol untuk switch tema
- **PENTING:** Jangan gunakan `'use client'` di layout karena butuh export `metadata`

---

### Step 5: Create `components/ThemeToggle.tsx`

Buat file baru untuk toggle button:

```tsx
"use client"

import { useTheme } from 'next-themes'
import { useEffect, useState } from 'react'

export default function ThemeToggle() {
  const { theme, setTheme, systemTheme } = useTheme()
  const [mounted, setMounted] = useState(false)

  useEffect(() => setMounted(true), [])
  if (!mounted) return null

  const currentTheme = theme === 'system' ? systemTheme : theme

  return (
    <button
      onClick={() => setTheme(currentTheme === 'dark' ? 'light' : 'dark')}
      className="px-3 py-1 rounded-md border dark:border-gray-600"
      aria-label="Toggle theme"
    >
      {currentTheme === 'dark' ? 'Light' : 'Dark'}
    </button>
  )
}
```

**Penjelasan:**
- `"use client"` â†’ Component ini butuh client-side hook `useTheme()`
- `useTheme()` hook â†’ Akses dan set theme
- `mounted` state â†’ Hindari hydration mismatch (penting!)
- `currentTheme` â†’ Resolve 'system' ke actual theme (light/dark)
- Button styling:
  - `dark:border-gray-600` â†’ Border color berubah di dark mode
  - Tailwind `dark:` prefix untuk style dark mode

---

### Step 6: Verify & Run

1. **Pastikan folder structure:**
   ```
   app/
   â”œâ”€â”€ globals.css
   â”œâ”€â”€ layout.tsx
   â”œâ”€â”€ page.tsx
   components/
   â””â”€â”€ ThemeToggle.tsx
   tailwind.config.js
   package.json
   ```

2. **Jalankan dev server:**
   ```bash
   npm run dev
   ```

3. **Test:**
   - Buka http://localhost:3000
   - Klik tombol theme toggle di top-right
   - Background dan text seharusnya berubah dengan smooth transition

---

## ğŸ¨ Customization

### Mengubah Warna Background/Text

Edit CSS variables di `app/globals.css`:

```css
:root {
  --bg: #f5f5f5;    /* Light mode background (custom) */
  --fg: #222222;    /* Light mode text (custom) */
}

html.dark {
  --bg: #1a1a1a;    /* Dark mode background (custom) */
  --fg: #e8e8e8;    /* Dark mode text (custom) */
}
```

### Styling Elements dengan Dark Mode

Gunakan Tailwind `dark:` prefix di className:

```tsx
<div className="bg-white dark:bg-gray-900 text-black dark:text-white">
  Content here
</div>
```

### Menambah Icon ke Toggle Button

Update `components/ThemeToggle.tsx`:

```tsx
{currentTheme === 'dark' ? 'â˜€ï¸ Light' : 'ğŸŒ™ Dark'}
```

---

## ğŸ“ File Changes Summary

| File | Status | Perubahan |
|------|--------|-----------|
| `tailwind.config.js` | âœï¸ Modified | Pastikan `darkMode: 'class'` |
| `app/globals.css` | âœï¸ Modified | Tambah CSS variables untuk light/dark |
| `app/layout.tsx` | âœï¸ Modified | Tambah `ThemeProvider` dan `ThemeToggle` |
| `components/ThemeToggle.tsx` | âœ¨ New | Component untuk toggle tema |
| `app/pages/_app.tsx` | âœï¸ Modified | Hapus duplicate `ThemeProvider` |

---

## ğŸ› Troubleshooting

### Background tidak berubah saat toggle

**Solusi:**
1. Pastikan `suppressHydrationWarning` ada di `<html>` tag
2. Refresh browser (Ctrl+R atau Cmd+R)
3. Buka DevTools â†’ Cek apakah class `dark` ada di `<html>` saat dark mode

### Tombol toggle tidak muncul

**Solusi:**
1. Pastikan folder `components/` ada di root (bukan di `app/`)
2. Verify import path: `import ThemeToggle from "../components/ThemeToggle"`
3. Pastikan component di-export default

### Hydration error

**Solusi:**
- Ini normal saat development. Pastikan ada:
  - `suppressHydrationWarning` di `<html>`
  - `if (!mounted) return null` di ThemeToggle

---

## ğŸ”— Resources

- [next-themes Documentation](https://github.com/pacocoursey/next-themes)
- [Tailwind CSS Dark Mode](https://tailwindcss.com/docs/dark-mode)
- [Next.js App Router](https://nextjs.org/docs/app)

---

## âœ… Checklist

- [ ] Dependencies installed (`npm install next-themes`)
- [ ] `tailwind.config.js` set to `darkMode: 'class'`
- [ ] `app/globals.css` updated dengan CSS variables
- [ ] `app/layout.tsx` updated dengan `ThemeProvider`
- [ ] `components/ThemeToggle.tsx` created
- [ ] Dev server running (`npm run dev`)
- [ ] Toggle button appears di top-right
- [ ] Background berubah saat toggle
- [ ] Tema persistent (reload page, tema tetap)

Setelah checklist selesai, light/dark mode setup sudah complete! âœ¨
